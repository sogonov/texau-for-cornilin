\begin{sloppypar} % помогает в кириллическом документе выровнять текст по краям
\newpage % Так добавляется  новая страница

% \section*{ВВЕДЕНИЕ}%так объявляется новая глава. * означает, что эта глава не попадает в оглавление и не имеет номера.
% \addcontentsline{toc}{section}{\hspace{1mm}ВВЕДЕНИЕ} % эта строчка нужна, чтобы такую главу в оглавление все таки добавить, но без номера. Такие госты, что поделать.
% введение я вообще снес нахуй, так как не придумал, что там писать.
\section{Формализация текстового задания.} %Объявили начало раздела

Исходное задание звучит так:

\textit{Часы с индикацией минут и секунд на четырехзначном семисегментном индикаторе}
 
 
Схематически цифровое устройство, реализующее данный функционал можно изобразить с помощью блок-схемы, изображенной на рисунке \ref{ris:Figures/1.png}.

\imgh{160.5mm}{Figures/1.png}{Блок-схема секундомера} %можно так вставить изображение

Первый счетчик делит частоту встроенного в отладочную плату осциллятора со 100 МГц до 10 Гц, что соответствует периоду в одну миллисекунду.

Счетчик миллисекунд считает количество этих импульсов, считая от 0 до 9. Следующий счетчик считает так же от 0 до 9, что соответствует единицам секунд. 

Аналогично следующие два счетчика соответствуют десяткам секунд(считает от 0 до 5) и единицам минут(от 0 до 9).

Текущее значение каждого из счетчиков поступает на дешифратор, и затем на мультиплексор, который управляет катодами семисегментного индикатора. 
 
На аноды каждого из 4 индикаторов напряжение подается поочередно, с частотой незаметной глазу. Это обеспечивается с помощью отдельного делителя частоты. В качестве переменной величины для мультиплексора можно взять несколько  меняющихся битов какого-то вектора. Это и даст поочередное переключение 4 индикаторов.

Функция start--stop будет реализована с помощью кнопки без фиксации: по первому нажатию секундомер запускается, по второму останавливается, из любого этих состояний секундомер можно сбросить, иначе говоря, в одном состоянии счет времени осуществляется, в другом - нет, на индикаторе будут изображены те цифры, что были до остановки.

\section{Описание устройства с помощью VHDL} 
Описаннный в предыдущем пункте функционал реализуется с помощью следующего описания устройства на языке VHDL:
 \inputminted[
% frame=lines,%линия сверху и снизу блока кода
% framesep=15mm, % отступ между линией и кодом
baselinestretch=1, %интервал междустрочный
 % bgcolor=LightGray, %цвет фона
fontsize=\footnotesize, %размер шрифта
% linenos%нумерация строк
]
{VHDL}%язык программирования
{delitel.vhd}%файл с кодом(должен лежать в папке проекта)
Данный код полностью описывает логику требуемого устройства.


\section{Симуляция устройства} %Объявили начало раздела
Чтобы проверить, как полученное с помощью этого описания устройство работает, нужно запустить симуляцию. Для сокращения времени симуляции был изменен кусок кода со счетчиком, считающим до 10 миллионов.
\begin{minted} [
% frame=lines,%линия сверху и снизу блока кода
% framesep=15mm, % отступ между линией и кодом
baselinestretch=1, %интервал междустрочный
 % bgcolor=LightGray, %цвет фона
fontsize=\footnotesize, %размер шрифта
% linenos%нумерация строк
]{VHDL}
--if cnt=to_unsigned(10_000_000,28) then cnt <= (others => '0'); --считаем до 10M 
if cnt=to_unsigned(1000,28) then cnt <= (others => '0'); --считаем до 1000 
\end{minted}


Так же для симуляции необходимо создать файл симуляции (Test bench) SIMM.vhd на языке VHDL, содержимое которого можно увидеть ниже:


\inputminted[
% frame=lines,%линия сверху и снизу блока кода
% framesep=15mm, % отступ между линией и кодом
baselinestretch=1, %интервал междустрочный
% bgcolor=LightGray, %цвет фона
fontsize=\footnotesize, %размер шрифта
% linenos%нумерация строк
]
{VHDL}%язык программирования
{SIMM.vhd}%файл с кодом(должен лежать в папке проекта)

После запуска симуляции были получены временные диаграммы, изображенные на рисунках \ref{ris:Figures/2.png}, \ref{ris:Figures/3.png}, \ref{ris:Figures/4.png}, \ref{ris:Figures/5.png}, \ref{ris:Figures/6.png}, \ref{ris:Figures/7.png}%, \ref{ris:Figures/8.png}.


В начальный момент времени значения всех счетчиков не определены. При сбросе с помощью сигнала reset значения счетчиков обнуляются, после чего начинается счет посредством счетчика cnt. Досчитав до 1000(вообще он должен до 100 миллионов считать, но для симуляции ждать такое значение бессмысленно), счетчик сбрасывается, передавая импульс следующему счетчику, считающего миллисекунды. Он, в свою очередь считает до 9, и тактует счетчик единиц секунд, считающего до 9. Аналогично обстоит дело со следующими счетчиками. Так же, можно просмотреть момент, когда при нажатии кнопки start-stop запускается и останавливается счет времени.

\newpage
\imghh{160.5mm}{Figures/2.png}{Нулевой момент времени, сброс всех сигналов сигналом reset, начало отсчета счетчика cnt} 
\imghh{160.5mm}{Figures/3_2.png}{Остановка счета времени повторным нажатием кнопки start-stop } 
\imghh{160.5mm}{Figures/3.png}{Переключение счетчика миллисекунд при приходе импульса от делителя тактовой частоты cnt} 
\imghh{160.5mm}{Figures/4.png}{Переключение счетчика единиц секунд счетчиком миллисекунд}
\imghh{160.5mm}{Figures/5.png}{Переключение счетчика десятков секунд счетчиком единиц секунд} 
\imghh{160.5mm}{Figures/6.png}{Переключение счетчика единиц минут счетчиком десятков минут} 
\imghh{160.5mm}{Figures/7.png}{Остановка счета нажатием кнопки start-stop -- значения счетчиков зафиксировались и не меняются} 
Таким образом, симуляцию можно считать успешной.


\section{Синтез цифрового устройства} %Объявили начало раздела
Для синтеза необходимо задать временные ограничения. Создаем файл временных ограничений, в котором нужно задать частоту тактового сигнала, в окне Primary Clocks. 

В результате синтеза была получена следующая схема(рисунок \ref{ris:Figures/sch.png})
\begin{landscape}
\imgh{250.5mm}{Figures/sch.png}{Синтезированная схема и сводка по времени} 
% текст в альбомной ориентации
% (таблица, рисунок, схема и т. п.)
\end{landscape}

\newpage
Система отмечает отсутствие ограничений Input и Output, а также группы no clock и unconstrained elements. Причина этого в том, что все счетчики тактируется выходным сигналом другого счетчика, который не указан в качестве тактового.

Так же на этом этапе необходимо указать внешние порты ввода-вывода для размещения схемы внутри ПЛИС. Сделать это нужно вручную, в соответствии со схемой, указанной в Board Reference Manual.


\imgh{160.5mm}{Figures/port.png}{Расположение портов ввода-вывода} 


\section{Реализация} %Объявили начало раздела
Следующий шаг разработки устройства – это реализация.
После завершения процесса реализации нужно проверить выполнение временных ограничений (Report Timing Summary)(рисунок \ref{ris:Figures/timing.png})
\imghh{160.5mm}{Figures/timing.png}{временная сводка после реализации} 
\section{Программирование ПЛИС} %Объявили начало раздела

Для программирования ПЛИС нужно выбрать Generate Bitstream на левой панели (Flow Navigator), а после завершения процесса открыть Hardware Manager, подключить кабель USB к отладочной плате (разъем PROG) и затем к компьютеру. Включить плату (переключатель POWER на плате), а также проверить правильность установки перемычек JP1 и JP2. 

В окне Hardware Manager необходимо выбрать ''Open Target'', а затем ''Auto Connect'' Если соединение будет успешным, надпись ''unconnected'' сменится на имя платы, появится кнопка ''Program Device''. При нажатиии на нее нужно выбрать отладочную плату, а затем файл с битовым потоком (с расширением
.bit) -- ''Bitstream file'' . Нажать ''Program''.

\section{Проверка функционирования устройства на отладочной плате} %Объявили начало раздела
После завершения программирования устройства была произведена проверка его работоспособности, в результате которой было выяснено, что устройство работает корректно. Функции, возложенные на кнопки reset, start-stop правильно работают, все описанные и требуемые заданием функции устройства работают.

\end{sloppypar}
